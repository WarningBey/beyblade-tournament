<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Warning BeyManager</title>
  <meta name="theme-color" content="#0f172a" />
  <link rel="stylesheet" href="./assets/css/estilos.css" />
</head>
<!-- Cr√©ditos (fijo abajo izquierda) -->
<a
  class="credit-badge"
  href="https://instagram.com/trujillo_diego_g"
  target="_blank"
  rel="noopener noreferrer"
  aria-label="Cr√©ditos de dise√±o: Diego Alejandro Guevara Trujillo (Instagram)"
>
  <span class="credit-title">Dise√±o:</span>
  <span class="credit-name">Diego Alejandro Guevara Trujillo</span>
  <span class="credit-sep">‚Ä¢</span>
  <span class="credit-ig">@trujillo_diego_g</span>
</a>

<body class="app-body">
  <!-- Fondo visual -->
  <div class="app-bg" aria-hidden="true"></div>

  <canvas id="confetti-canvas"></canvas>

  <input type="file" id="file-upload" accept=".json" class="hidden" onchange="loadTournamentFile(this)" />

  <!-- Modal Sorteo -->
  <div id="toss-modal" class="toss-modal" onclick="closeToss()">
    <div class="toss-content" onclick="event.stopPropagation()">
      <h2 class="toss-title">Sorteo</h2>
      <div class="coin-icon" id="coin-icon">üé≤</div>
      <div class="toss-result" id="toss-result">...</div>
      <div class="toss-buttons">
        <button class="btn btn-primary" onclick="spinToss()">Lanzar</button>
        <button class="btn btn-ghost" onclick="closeToss()">Cerrar</button>
      </div>
    </div>
  </div>

  <div id="toast" class="toast">Guardado</div>

  <div class="container">
    <!-- HEADER -->
    <header class="header header-min">
      <div class="header-min-left">
        <img class="header-min-logo" src="./assets/img/warning-logo.png" alt="Warning" />
        <div class="header-min-titles">
          <div class="header-min-title">Warning</div>
          <div class="header-min-subtitle">BeyManager</div>
        </div>
      </div>

      <nav class="header-min-right" aria-label="Navegaci√≥n principal">
        <button class="nav-link" onclick="document.getElementById('file-upload').click()">Carga</button>
        <button class="nav-link" onclick="downloadBackup()">Exportar</button>
        <button class="nav-link" onclick="goBackStep()">Volver</button>
        <button class="nav-link nav-link--active" onclick="goHome()">Inicio</button>
      </nav>
    </header>

    <!-- Vista: Registro -->
    <section id="view-registration" class="view view-center">
      <div class="card card-narrow card-glass registration-card">

        <div class="card-head">
          <h2 class="card-title card-title-clean">Registro de Bladers</h2>
        </div>

        <!-- ‚úÖ Layout estable tipo ‚Äúpanel‚Äù (como referencia) -->
        <div class="reg-layout">
          <!-- Input + -->
          <div class="reg-add">
            <input id="input-player" class="input-dark input-glass" placeholder="Nombre..." autocomplete="off" />
            <button class="btn btn-primary btn-plus btn-plus-glow" onclick="addPlayer()">+</button>

            <div class="reg-total">
              Total: <span id="player-counter">0</span>
            </div>
          </div>

          <!-- Lista -->
          <div class="reg-list-head">
            <span class="reg-list-title">Lista de Inscritos</span>
          </div>

          <div id="player-list" class="lista-inscritos"></div>

          <!-- Config abajo de la lista -->
          <div id="group-config" class="config-block config-glass hidden">
            <div class="config-row">
              <span class="config-label">Grupos:</span>
              <input type="range" id="group-slider" min="1" max="1" value="1" oninput="updateGroupCount(this.value)" />
              <span id="group-count-label" class="pill pill-glass">1</span>
            </div>

            <div class="config-row" id="rounds-config-row">
              <span class="config-label">Rondas:</span>
              <input
                type="number"
                id="rounds-input"
                class="input-dark input-mini input-glass"
                min="1"
                max="10"
                value="1"
                onchange="setRounds(this.value)"
              />
              <span id="rounds-max-msg" class="muted tiny"></span>
            </div>
          </div>

          <!-- ‚úÖ Bot√≥n al final (como ejemplo) -->
          <button id="btn-start" class="btn btn-success w-100 btn-start-hero" onclick="generateGroups()" disabled>
            INICIAR TORNEO
          </button>

          <div class="reg-footnote muted tiny">
            Tip: con 10+ bladers queda m√°s parejo üí™
          </div>
        </div>

      </div>
    </section>

    <!-- Vista: Grupos -->
    <section id="view-groups" class="view hidden">
      <h2 class="title">Fase de Grupos</h2>

      <div class="general-panel card card-glass">
        <div class="general-toolbar">
          <div class="general-left">
            <h3 class="subtitle table-help-title">
              Tabla General
              <span class="table-help-icon" tabindex="0">‚ÑπÔ∏è</span>

              <div class="table-help-tooltip">
                <strong>üìä M√©tricas</strong>
                <ul>
                  <li><b>PL</b> ‚Äî Puntos de Liga</li>
                  <li><b>PT</b> ‚Äî Puntos Totales</li>
                  <li><b>PC</b> ‚Äî Puntos en Contra</li>
                  <li><b>WIN</b> ‚Äî Victorias</li>
                </ul>

                <hr />

                <strong>üî¢ Orden de Prioridad</strong>
                <ol>
                  <li><b>PL</b></li>
                  <li><b>PT</b></li>
                  <li><b>PC</b></li>
                </ol>
              </div>
            </h3>
          </div>

          <div class="general-right">
            <button class="btn btn-blue-ghost btn-small" onclick="redistributeGroups()">‚Üª Redistribuir</button>
            <button class="btn btn-whatsapp btn-small" onclick="copyStandingsToClipboard()">üì± Copiar</button>

            <select
              id="knockout-size-select"
              class="select-top select-top--small"
              onchange="setKnockoutSize(this.value); renderGeneralTable(); renderGlobalStandings();"
            >
              <option value="2">Top 2</option>
              <option value="4">Top 4</option>
              <option value="8" selected>Top 8</option>
            </select>

            <button class="btn btn-warning btn-small" onclick="startKnockout()">Ir Eliminatoria ¬ª</button>
          </div>
        </div>

        <div id="general-table"></div>
      </div>

      <div id="groups-container" class="groups-container"></div>
    </section>

    <!-- Vista: Eliminatorias -->
    <section id="view-knockout" class="view hidden">
      <h2 class="title title-center title-gold">Fase Eliminatoria</h2>

      <div class="knockout-head">
        <span id="round-badge" class="round-badge">Ronda 1</span>
      </div>

      <div class="knockout-stage">
        <select
          id="knockout-round-select"
          class="input-dark input-round hidden"
          onchange="selectKnockoutRound(this.value)">
        </select>

        <div id="knockout-container" class="knockout-container"></div>

        <div class="knockout-actions">
          <button class="btn btn-primary btn-advance" onclick="advanceRound()">
            Confirmar Resultados y Avanzar
          </button>
        </div>
      </div>
    </section>

    <!-- Vista: Ganador -->
    <section id="view-winner" class="view hidden">
      <div id="winner-card" class="card winner-card"></div>
    </section>
  </div>

  <script type="module" src="./assets/js/app.js"></script>
</body>
</html>
